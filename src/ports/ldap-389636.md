# LDAP (389/636)

### Anonymous bind enum

Find base DN — Starting point for LDAP enum

```bash
ldapsearch -x -H ldap://$IP -b '' -s base namingContexts
```

<details>
<summary>Example Output</summary>

```
ldapsearch -x -H ldap://10.10.10.5
namingContexts: DC=corp,DC=local
(SUCCESS = anonymous LDAP access)
```
</details>

---

### Dump all objects

Full LDAP dump — Users, groups, computers, OUs

```bash
ldapsearch -x -H ldap://$IP -b 'DC=domain,DC=local'
```

<details>
<summary>Example Output</summary>

```
ldapsearch -x -H ldap://10.10.10.5 -b 'DC=corp,DC=local'
dn: CN=John Smith,OU=Users,DC=corp,DC=local
sAMAccountName: john.smith
description: Temp password: Welcome1
(PASSWORD IN DESCRIPTION FIELD)
```
</details>

---

### Enum users

All AD users — Build user list

```bash
ldapsearch -x -H ldap://$IP -b 'DC=domain,DC=local' '(objectClass=user)' sAMAccountName
```

<details>
<summary>Example Output</summary>

```
ldapsearch -x -H ldap://10.10.10.5 -b 'DC=corp,DC=local' '(objectClass=person)' sAMAccountName
dn: CN=John Smith,OU=Users,DC=corp,DC=local
sAMAccountName: john.smith

dn: CN=SVC SQL,OU=Service Accounts,DC=corp,DC=local
sAMAccountName: svc_sql
(Full user list from LDAP)
```
</details>

---

### Nmap LDAP scripts

Automated LDAP enum — Quick overview

```bash
nmap --script ldap-* -p 389 $IP
```

<details>
<summary>Example Output</summary>

```
nmap --script ldap-* -p 389 10.10.10.5
| ldap-rootdse:
|   namingContexts: DC=corp,DC=local
|   domainFunctionality: 7 (2016)
|_  forestFunctionality: 7
```
</details>

---

### Check for password in description

Users with passwords in desc field — Lazy admins store creds here

```bash
ldapsearch -x -H ldap://$IP -b 'DC=domain,DC=local' '(objectClass=user)' sAMAccountName description
```

<details>
<summary>Example Output</summary>

```
ldapsearch -x -H ldap://10.10.10.5 -b 'DC=corp,DC=local' '(description=*pass*)'
dn: CN=svc_backup,OU=Service,DC=corp,DC=local
description: Password is Backup2024!
(CLEARTEXT PASSWORD IN LDAP)
```
</details>

---
